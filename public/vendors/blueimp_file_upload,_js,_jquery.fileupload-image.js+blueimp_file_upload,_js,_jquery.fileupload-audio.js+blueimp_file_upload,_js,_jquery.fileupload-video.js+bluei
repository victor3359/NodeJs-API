var mod_pagespeed_1OOHXvoqi7 = ";(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','load-image','load-image-meta','load-image-exif','canvas-to-blob','./jquery.fileupload-process'],factory);}else if(typeof exports==='object'){factory(require('jquery'),require('blueimp-load-image/js/load-image'),require('blueimp-load-image/js/load-image-meta'),require('blueimp-load-image/js/load-image-exif'),require('blueimp-canvas-to-blob'),require('./jquery.fileupload-process'));}else{factory(window.jQuery,window.loadImage);}}(function($,loadImage){'use strict';$.blueimp.fileupload.prototype.options.processQueue.unshift({action:'loadImageMetaData',disableImageHead:'@',disableExif:'@',disableExifThumbnail:'@',disableExifSub:'@',disableExifGps:'@',disabled:'@disableImageMetaDataLoad'},{action:'loadImage',prefix:true,fileTypes:'@',maxFileSize:'@',noRevoke:'@',disabled:'@disableImageLoad'},{action:'resizeImage',prefix:'image',maxWidth:'@',maxHeight:'@',minWidth:'@',minHeight:'@',crop:'@',orientation:'@',forceResize:'@',disabled:'@disableImageResize'},{action:'saveImage',quality:'@imageQuality',type:'@imageType',disabled:'@disableImageResize'},{action:'saveImageMetaData',disabled:'@disableImageMetaDataSave'},{action:'resizeImage',prefix:'preview',maxWidth:'@',maxHeight:'@',minWidth:'@',minHeight:'@',crop:'@',orientation:'@',thumbnail:'@',canvas:'@',disabled:'@disableImagePreview'},{action:'setImage',name:'@imagePreviewName',disabled:'@disableImagePreview'},{action:'deleteImageReferences',disabled:'@disableImageReferencesDeletion'});$.widget('blueimp.fileupload',$.blueimp.fileupload,{options:{loadImageFileTypes:/^image\\/(gif|jpeg|png|svg\\+xml)$/,loadImageMaxFileSize:10000000,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:false,imageCrop:false,disableImageResize:true,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:true,previewThumbnail:true,previewCrop:false,previewCanvas:true},processActions:{loadImage:function(data,options){if(options.disabled){return data;}var that=this,file=data.files[data.index],dfd=$.Deferred();if(($.type(options.maxFileSize)==='number'&&file.size>options.maxFileSize)||(options.fileTypes&&!options.fileTypes.test(file.type))||!loadImage(file,function(img){if(img.src){data.img=img;}dfd.resolveWith(that,[data]);},options)){return data;}return dfd.promise();},resizeImage:function(data,options){if(options.disabled||!(data.canvas||data.img)){return data;}options=$.extend({canvas:true},options);var that=this,dfd=$.Deferred(),img=(options.canvas&&data.canvas)||data.img,resolve=function(newImg){if(newImg&&(newImg.width!==img.width||newImg.height!==img.height||options.forceResize)){data[newImg.getContext?'canvas':'img']=newImg;}data.preview=newImg;dfd.resolveWith(that,[data]);},thumbnail;if(data.exif){if(options.orientation===true){options.orientation=data.exif.get('Orientation');}if(options.thumbnail){thumbnail=data.exif.get('Thumbnail');if(thumbnail){loadImage(thumbnail,resolve,options);return dfd.promise();}}if(data.orientation){delete options.orientation;}else{data.orientation=options.orientation;}}if(img){resolve(loadImage.scale(img,options));return dfd.promise();}return data;},saveImage:function(data,options){if(!data.canvas||options.disabled){return data;}var that=this,file=data.files[data.index],dfd=$.Deferred();if(data.canvas.toBlob){data.canvas.toBlob(function(blob){if(!blob.name){if(file.type===blob.type){blob.name=file.name;}else if(file.name){blob.name=file.name.replace(/\\.\\w+$/,'.'+blob.type.substr(6));}}if(file.type!==blob.type){delete data.imageHead;}data.files[data.index]=blob;dfd.resolveWith(that,[data]);},options.type||file.type,options.quality);}else{return data;}return dfd.promise();},loadImageMetaData:function(data,options){if(options.disabled){return data;}var that=this,dfd=$.Deferred();loadImage.parseMetaData(data.files[data.index],function(result){$.extend(data,result);dfd.resolveWith(that,[data]);},options);return dfd.promise();},saveImageMetaData:function(data,options){if(!(data.imageHead&&data.canvas&&data.canvas.toBlob&&!options.disabled)){return data;}var file=data.files[data.index],blob=new Blob([data.imageHead,this._blobSlice.call(file,20)],{type:file.type});blob.name=file.name;data.files[data.index]=blob;return data;},setImage:function(data,options){if(data.preview&&!options.disabled){data.files[data.index][options.name||'preview']=data.preview;}return data;},deleteImageReferences:function(data,options){if(!options.disabled){delete data.img;delete data.canvas;delete data.preview;delete data.imageHead;}return data;}}});}));";
var mod_pagespeed_KwvuQmif5a = ";(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','load-image','./jquery.fileupload-process'],factory);}else if(typeof exports==='object'){factory(require('jquery'),require('blueimp-load-image/js/load-image'),require('./jquery.fileupload-process'));}else{factory(window.jQuery,window.loadImage);}}(function($,loadImage){'use strict';$.blueimp.fileupload.prototype.options.processQueue.unshift({action:'loadAudio',prefix:true,fileTypes:'@',maxFileSize:'@',disabled:'@disableAudioPreview'},{action:'setAudio',name:'@audioPreviewName',disabled:'@disableAudioPreview'});$.widget('blueimp.fileupload',$.blueimp.fileupload,{options:{loadAudioFileTypes:/^audio\\/.*$/},_audioElement:document.createElement('audio'),processActions:{loadAudio:function(data,options){if(options.disabled){return data;}var file=data.files[data.index],url,audio;if(this._audioElement.canPlayType&&this._audioElement.canPlayType(file.type)&&($.type(options.maxFileSize)!=='number'||file.size<=options.maxFileSize)&&(!options.fileTypes||options.fileTypes.test(file.type))){url=loadImage.createObjectURL(file);if(url){audio=this._audioElement.cloneNode(false);audio.src=url;audio.controls=true;data.audio=audio;return data;}}return data;},setAudio:function(data,options){if(data.audio&&!options.disabled){data.files[data.index][options.name||'preview']=data.audio;}return data;}}});}));";
var mod_pagespeed_SfXDDtIwns = ";(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','load-image','./jquery.fileupload-process'],factory);}else if(typeof exports==='object'){factory(require('jquery'),require('blueimp-load-image/js/load-image'),require('./jquery.fileupload-process'));}else{factory(window.jQuery,window.loadImage);}}(function($,loadImage){'use strict';$.blueimp.fileupload.prototype.options.processQueue.unshift({action:'loadVideo',prefix:true,fileTypes:'@',maxFileSize:'@',disabled:'@disableVideoPreview'},{action:'setVideo',name:'@videoPreviewName',disabled:'@disableVideoPreview'});$.widget('blueimp.fileupload',$.blueimp.fileupload,{options:{loadVideoFileTypes:/^video\\/.*$/},_videoElement:document.createElement('video'),processActions:{loadVideo:function(data,options){if(options.disabled){return data;}var file=data.files[data.index],url,video;if(this._videoElement.canPlayType&&this._videoElement.canPlayType(file.type)&&($.type(options.maxFileSize)!=='number'||file.size<=options.maxFileSize)&&(!options.fileTypes||options.fileTypes.test(file.type))){url=loadImage.createObjectURL(file);if(url){video=this._videoElement.cloneNode(false);video.src=url;video.controls=true;data.video=video;return data;}}return data;},setVideo:function(data,options){if(data.video&&!options.disabled){data.files[data.index][options.name||'preview']=data.video;}return data;}}});}));";
var mod_pagespeed_q3bcDt2IHf = ";(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','./jquery.fileupload-process'],factory);}else if(typeof exports==='object'){factory(require('jquery'),require('./jquery.fileupload-process'));}else{factory(window.jQuery);}}(function($){'use strict';$.blueimp.fileupload.prototype.options.processQueue.push({action:'validate',always:true,acceptFileTypes:'@',maxFileSize:'@',minFileSize:'@',maxNumberOfFiles:'@',disabled:'@disableValidation'});$.widget('blueimp.fileupload',$.blueimp.fileupload,{options:{getNumberOfFiles:$.noop,messages:{maxNumberOfFiles:'Maximum number of files exceeded',acceptFileTypes:'File type not allowed',maxFileSize:'File is too large',minFileSize:'File is too small'}},processActions:{validate:function(data,options){if(options.disabled){return data;}var dfd=$.Deferred(),settings=this.options,file=data.files[data.index],fileSize;if(options.minFileSize||options.maxFileSize){fileSize=file.size;}if($.type(options.maxNumberOfFiles)==='number'&&(settings.getNumberOfFiles()||0)+data.files.length>options.maxNumberOfFiles){file.error=settings.i18n('maxNumberOfFiles');}else if(options.acceptFileTypes&&!(options.acceptFileTypes.test(file.type)||options.acceptFileTypes.test(file.name))){file.error=settings.i18n('acceptFileTypes');}else if(fileSize>options.maxFileSize){file.error=settings.i18n('maxFileSize');}else if($.type(fileSize)==='number'&&fileSize<options.minFileSize){file.error=settings.i18n('minFileSize');}else{delete file.error;}if(file.error||data.files.error){data.files.error=true;dfd.rejectWith(this,[data]);}else{dfd.resolveWith(this,[data]);}return dfd.promise();}}});}));";
var mod_pagespeed_wrG6h9LbSi = ";(function(factory){'use strict';if(typeof define==='function'&&define.amd){define(['jquery','blueimp-tmpl','./jquery.fileupload-image','./jquery.fileupload-audio','./jquery.fileupload-video','./jquery.fileupload-validate'],factory);}else if(typeof exports==='object'){factory(require('jquery'),require('blueimp-tmpl'),require('./jquery.fileupload-image'),require('./jquery.fileupload-video'),require('./jquery.fileupload-validate'));}else{factory(window.jQuery,window.tmpl);}}(function($,tmpl){'use strict';$.blueimp.fileupload.prototype._specialOptions.push('filesContainer','uploadTemplateId','downloadTemplateId');$.widget('blueimp.fileupload',$.blueimp.fileupload,{options:{autoUpload:false,uploadTemplateId:'template-upload',downloadTemplateId:'template-download',filesContainer:undefined,prependFiles:false,dataType:'json',messages:{unknownError:'Unknown error'},getNumberOfFiles:function(){return this.filesContainer.children().not('.processing').length;},getFilesFromResponse:function(data){if(data.result&&$.isArray(data.result.files)){return data.result.files;}return[];},add:function(e,data){if(e.isDefaultPrevented()){return false;}var $this=$(this),that=$this.data('blueimp-fileupload')||$this.data('fileupload'),options=that.options;data.context=that._renderUpload(data.files).data('data',data).addClass('processing');options.filesContainer[options.prependFiles?'prepend':'append'](data.context);that._forceReflow(data.context);that._transition(data.context);data.process(function(){return $this.fileupload('process',data);}).always(function(){data.context.each(function(index){$(this).find('.size').text(that._formatFileSize(data.files[index].size));}).removeClass('processing');that._renderPreviews(data);}).done(function(){data.context.find('.start').prop('disabled',false);if((that._trigger('added',e,data)!==false)&&(options.autoUpload||data.autoUpload)&&data.autoUpload!==false){data.submit();}}).fail(function(){if(data.files.error){data.context.each(function(index){var error=data.files[index].error;if(error){$(this).find('.error').text(error);}});}});},send:function(e,data){if(e.isDefaultPrevented()){return false;}var that=$(this).data('blueimp-fileupload')||$(this).data('fileupload');if(data.context&&data.dataType&&data.dataType.substr(0,6)==='iframe'){data.context.find('.progress').addClass(!$.support.transition&&'progress-animated').attr('aria-valuenow',100).children().first().css('width','100%');}return that._trigger('sent',e,data);},done:function(e,data){if(e.isDefaultPrevented()){return false;}var that=$(this).data('blueimp-fileupload')||$(this).data('fileupload'),getFilesFromResponse=data.getFilesFromResponse||that.options.getFilesFromResponse,files=getFilesFromResponse(data),template,deferred;if(data.context){data.context.each(function(index){var file=files[index]||{error:'Empty file upload result'};deferred=that._addFinishedDeferreds();that._transition($(this)).done(function(){var node=$(this);template=that._renderDownload([file]).replaceAll(node);that._forceReflow(template);that._transition(template).done(function(){data.context=$(this);that._trigger('completed',e,data);that._trigger('finished',e,data);deferred.resolve();});});});}else{template=that._renderDownload(files)[that.options.prependFiles?'prependTo':'appendTo'](that.options.filesContainer);that._forceReflow(template);deferred=that._addFinishedDeferreds();that._transition(template).done(function(){data.context=$(this);that._trigger('completed',e,data);that._trigger('finished',e,data);deferred.resolve();});}},fail:function(e,data){if(e.isDefaultPrevented()){return false;}var that=$(this).data('blueimp-fileupload')||$(this).data('fileupload'),template,deferred;if(data.context){data.context.each(function(index){if(data.errorThrown!=='abort'){var file=data.files[index];file.error=file.error||data.errorThrown||data.i18n('unknownError');deferred=that._addFinishedDeferreds();that._transition($(this)).done(function(){var node=$(this);template=that._renderDownload([file]).replaceAll(node);that._forceReflow(template);that._transition(template).done(function(){data.context=$(this);that._trigger('failed',e,data);that._trigger('finished',e,data);deferred.resolve();});});}else{deferred=that._addFinishedDeferreds();that._transition($(this)).done(function(){$(this).remove();that._trigger('failed',e,data);that._trigger('finished',e,data);deferred.resolve();});}});}else if(data.errorThrown!=='abort'){data.context=that._renderUpload(data.files)[that.options.prependFiles?'prependTo':'appendTo'](that.options.filesContainer).data('data',data);that._forceReflow(data.context);deferred=that._addFinishedDeferreds();that._transition(data.context).done(function(){data.context=$(this);that._trigger('failed',e,data);that._trigger('finished',e,data);deferred.resolve();});}else{that._trigger('failed',e,data);that._trigger('finished',e,data);that._addFinishedDeferreds().resolve();}},progress:function(e,data){if(e.isDefaultPrevented()){return false;}var progress=Math.floor(data.loaded/data.total*100);if(data.context){data.context.each(function(){$(this).find('.progress').attr('aria-valuenow',progress).children().first().css('width',progress+'%');});}},progressall:function(e,data){if(e.isDefaultPrevented()){return false;}var $this=$(this),progress=Math.floor(data.loaded/data.total*100),globalProgressNode=$this.find('.fileupload-progress'),extendedProgressNode=globalProgressNode.find('.progress-extended');if(extendedProgressNode.length){extendedProgressNode.html(($this.data('blueimp-fileupload')||$this.data('fileupload'))._renderExtendedProgress(data));}globalProgressNode.find('.progress').attr('aria-valuenow',progress).children().first().css('width',progress+'%');},start:function(e){if(e.isDefaultPrevented()){return false;}var that=$(this).data('blueimp-fileupload')||$(this).data('fileupload');that._resetFinishedDeferreds();that._transition($(this).find('.fileupload-progress')).done(function(){that._trigger('started',e);});},stop:function(e){if(e.isDefaultPrevented()){return false;}var that=$(this).data('blueimp-fileupload')||$(this).data('fileupload'),deferred=that._addFinishedDeferreds();$.when.apply($,that._getFinishedDeferreds()).done(function(){that._trigger('stopped',e);});that._transition($(this).find('.fileupload-progress')).done(function(){$(this).find('.progress').attr('aria-valuenow','0').children().first().css('width','0%');$(this).find('.progress-extended').html('&nbsp;');deferred.resolve();});},processstart:function(e){if(e.isDefaultPrevented()){return false;}$(this).addClass('fileupload-processing');},processstop:function(e){if(e.isDefaultPrevented()){return false;}$(this).removeClass('fileupload-processing');},destroy:function(e,data){if(e.isDefaultPrevented()){return false;}var that=$(this).data('blueimp-fileupload')||$(this).data('fileupload'),removeNode=function(){that._transition(data.context).done(function(){$(this).remove();that._trigger('destroyed',e,data);});};if(data.url){data.dataType=data.dataType||that.options.dataType;$.ajax(data).done(removeNode).fail(function(){that._trigger('destroyfailed',e,data);});}else{removeNode();}}},_resetFinishedDeferreds:function(){this._finishedUploads=[];},_addFinishedDeferreds:function(deferred){if(!deferred){deferred=$.Deferred();}this._finishedUploads.push(deferred);return deferred;},_getFinishedDeferreds:function(){return this._finishedUploads;},_enableDragToDesktop:function(){var link=$(this),url=link.prop('href'),name=link.prop('download'),type='application/octet-stream';link.bind('dragstart',function(e){try{e.originalEvent.dataTransfer.setData('DownloadURL',[type,name,url].join(':'));}catch(ignore){}});},_formatFileSize:function(bytes){if(typeof bytes!=='number'){return'';}if(bytes>=1000000000){return(bytes/1000000000).toFixed(2)+' GB';}if(bytes>=1000000){return(bytes/1000000).toFixed(2)+' MB';}return(bytes/1000).toFixed(2)+' KB';},_formatBitrate:function(bits){if(typeof bits!=='number'){return'';}if(bits>=1000000000){return(bits/1000000000).toFixed(2)+' Gbit/s';}if(bits>=1000000){return(bits/1000000).toFixed(2)+' Mbit/s';}if(bits>=1000){return(bits/1000).toFixed(2)+' kbit/s';}return bits.toFixed(2)+' bit/s';},_formatTime:function(seconds){var date=new Date(seconds*1000),days=Math.floor(seconds/86400);days=days?days+'d ':'';return days+('0'+date.getUTCHours()).slice(-2)+':'+('0'+date.getUTCMinutes()).slice(-2)+':'+('0'+date.getUTCSeconds()).slice(-2);},_formatPercentage:function(floatValue){return(floatValue*100).toFixed(2)+' %';},_renderExtendedProgress:function(data){return this._formatBitrate(data.bitrate)+' | '+this._formatTime((data.total-data.loaded)*8/data.bitrate)+' | '+this._formatPercentage(data.loaded/data.total)+' | '+this._formatFileSize(data.loaded)+' / '+this._formatFileSize(data.total);},_renderTemplate:function(func,files){if(!func){return $();}var result=func({files:files,formatFileSize:this._formatFileSize,options:this.options});if(result instanceof $){return result;}return $(this.options.templatesContainer).html(result).children();},_renderPreviews:function(data){data.context.find('.preview').each(function(index,elm){$(elm).append(data.files[index].preview);});},_renderUpload:function(files){return this._renderTemplate(this.options.uploadTemplate,files);},_renderDownload:function(files){return this._renderTemplate(this.options.downloadTemplate,files).find('a[download]').each(this._enableDragToDesktop).end();},_startHandler:function(e){e.preventDefault();var button=$(e.currentTarget),template=button.closest('.template-upload'),data=template.data('data');button.prop('disabled',true);if(data&&data.submit){data.submit();}},_cancelHandler:function(e){e.preventDefault();var template=$(e.currentTarget).closest('.template-upload,.template-download'),data=template.data('data')||{};data.context=data.context||template;if(data.abort){data.abort();}else{data.errorThrown='abort';this._trigger('fail',e,data);}},_deleteHandler:function(e){e.preventDefault();var button=$(e.currentTarget);this._trigger('destroy',e,$.extend({context:button.closest('.template-download'),type:'DELETE'},button.data()));},_forceReflow:function(node){return $.support.transition&&node.length&&node[0].offsetWidth;},_transition:function(node){var dfd=$.Deferred();if($.support.transition&&node.hasClass('fade')&&node.is(':visible')){node.bind($.support.transition.end,function(e){if(e.target===node[0]){node.unbind($.support.transition.end);dfd.resolveWith(node);}}).toggleClass('in');}else{node.toggleClass('in');dfd.resolveWith(node);}return dfd;},_initButtonBarEventHandlers:function(){var fileUploadButtonBar=this.element.find('.fileupload-buttonbar'),filesList=this.options.filesContainer;this._on(fileUploadButtonBar.find('.start'),{click:function(e){e.preventDefault();filesList.find('.start').click();}});this._on(fileUploadButtonBar.find('.cancel'),{click:function(e){e.preventDefault();filesList.find('.cancel').click();}});this._on(fileUploadButtonBar.find('.delete'),{click:function(e){e.preventDefault();filesList.find('.toggle:checked').closest('.template-download').find('.delete').click();fileUploadButtonBar.find('.toggle').prop('checked',false);}});this._on(fileUploadButtonBar.find('.toggle'),{change:function(e){filesList.find('.toggle').prop('checked',$(e.currentTarget).is(':checked'));}});},_destroyButtonBarEventHandlers:function(){this._off(this.element.find('.fileupload-buttonbar').find('.start, .cancel, .delete'),'click');this._off(this.element.find('.fileupload-buttonbar .toggle'),'change.');},_initEventHandlers:function(){this._super();this._on(this.options.filesContainer,{'click .start':this._startHandler,'click .cancel':this._cancelHandler,'click .delete':this._deleteHandler});this._initButtonBarEventHandlers();},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers();this._off(this.options.filesContainer,'click');this._super();},_enableFileInputButton:function(){this.element.find('.fileinput-button input').prop('disabled',false).parent().removeClass('disabled');},_disableFileInputButton:function(){this.element.find('.fileinput-button input').prop('disabled',true).parent().addClass('disabled');},_initTemplates:function(){var options=this.options;options.templatesContainer=this.document[0].createElement(options.filesContainer.prop('nodeName'));if(tmpl){if(options.uploadTemplateId){options.uploadTemplate=tmpl(options.uploadTemplateId);}if(options.downloadTemplateId){options.downloadTemplate=tmpl(options.downloadTemplateId);}}},_initFilesContainer:function(){var options=this.options;if(options.filesContainer===undefined){options.filesContainer=this.element.find('.files');}else if(!(options.filesContainer instanceof $)){options.filesContainer=$(options.filesContainer);}},_initSpecialOptions:function(){this._super();this._initFilesContainer();this._initTemplates();},_create:function(){this._super();this._resetFinishedDeferreds();if(!$.support.fileInput){this._disableFileInputButton();}},enable:function(){var wasDisabled=false;if(this.options.disabled){wasDisabled=true;}this._super();if(wasDisabled){this.element.find('input, button').prop('disabled',false);this._enableFileInputButton();}},disable:function(){if(!this.options.disabled){this.element.find('input, button').prop('disabled',true);this._disableFileInputButton();}this._super();}});}));";
var mod_pagespeed_XYVEIm4atW = ";(function(root,factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports==='object'){module.exports=factory(require('jquery'));}else{root.Dropify=factory(root.jQuery);}}(this,function($){var pluginName=\"dropify\";function Dropify(element,options){if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){return;}var defaults={defaultFile:'',maxFileSize:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,showRemove:true,showLoader:true,showErrors:true,errorTimeout:3000,errorsPosition:'overlay',imgFileExtensions:['png','jpg','jpeg','gif','bmp'],maxFileSizePreview:\"5M\",allowedFormats:['portrait','square','landscape'],allowedFileExtensions:['*'],messages:{'default':'Drag and drop a file here or click','replace':'Drag and drop or click to replace','remove':'Remove','error':'Ooops, something wrong happended.'},error:{'fileSize':'The file size is too big ({{ value }} max).','minWidth':'The image width is too small ({{ value }}}px min).','maxWidth':'The image width is too big ({{ value }}}px max).','minHeight':'The image height is too small ({{ value }}}px min).','maxHeight':'The image height is too big ({{ value }}px max).','imageFormat':'The image format is not allowed ({{ value }} only).','fileExtension':'The file is not allowed ({{ value }} only).'},tpl:{wrap:'<div class=\"dropify-wrapper\"></div>',loader:'<div class=\"dropify-loader\"></div>',message:'<div class=\"dropify-message\"><span class=\"file-icon\" /> <p>{{ default }}</p></div>',preview:'<div class=\"dropify-preview\"><span class=\"dropify-render\"></span><div class=\"dropify-infos\"><div class=\"dropify-infos-inner\"><p class=\"dropify-infos-message\">{{ replace }}</p></div></div></div>',filename:'<p class=\"dropify-filename\"><span class=\"dropify-filename-inner\"></span></p>',clearButton:'<button type=\"button\" class=\"dropify-clear\">{{ remove }}</button>',errorLine:'<p class=\"dropify-error\">{{ error }}</p>',errorsContainer:'<div class=\"dropify-errors-container\"><ul></ul></div>'}};this.element=element;this.input=$(this.element);this.wrapper=null;this.preview=null;this.filenameWrapper=null;this.settings=$.extend(true,defaults,options,this.input.data());this.errorsEvent=$.Event('dropify.errors');this.isDisabled=false;this.isInit=false;this.file={object:null,name:null,size:null,width:null,height:null,type:null};if(!Array.isArray(this.settings.allowedFormats)){this.settings.allowedFormats=this.settings.allowedFormats.split(' ');}if(!Array.isArray(this.settings.allowedFileExtensions)){this.settings.allowedFileExtensions=this.settings.allowedFileExtensions.split(' ');}this.onChange=this.onChange.bind(this);this.clearElement=this.clearElement.bind(this);this.onFileReady=this.onFileReady.bind(this);this.translateMessages();this.createElements();this.setContainerSize();this.errorsEvent.errors=[];this.input.on('change',this.onChange);}Dropify.prototype.onChange=function(){this.resetPreview();this.readFile(this.element);};Dropify.prototype.createElements=function(){this.isInit=true;this.input.wrap($(this.settings.tpl.wrap));this.wrapper=this.input.parent();var messageWrapper=$(this.settings.tpl.message).insertBefore(this.input);$(this.settings.tpl.errorLine).appendTo(messageWrapper);if(this.isTouchDevice()===true){this.wrapper.addClass('touch-fallback');}if(this.input.attr('disabled')){this.isDisabled=true;this.wrapper.addClass('disabled');}if(this.settings.showLoader===true){this.loader=$(this.settings.tpl.loader);this.loader.insertBefore(this.input);}this.preview=$(this.settings.tpl.preview);this.preview.insertAfter(this.input);if(this.isDisabled===false&&this.settings.showRemove===true){this.clearButton=$(this.settings.tpl.clearButton);this.clearButton.insertAfter(this.input);this.clearButton.on('click',this.clearElement);}this.filenameWrapper=$(this.settings.tpl.filename);this.filenameWrapper.prependTo(this.preview.find('.dropify-infos-inner'));if(this.settings.showErrors===true){this.errorsContainer=$(this.settings.tpl.errorsContainer);if(this.settings.errorsPosition==='outside'){this.errorsContainer.insertAfter(this.wrapper);}else{this.errorsContainer.insertBefore(this.input);}}var defaultFile=this.settings.defaultFile||'';if(defaultFile.trim()!==''){this.file.name=this.cleanFilename(defaultFile);this.setPreview(this.isImage(),defaultFile);}};Dropify.prototype.readFile=function(input){if(input.files&&input.files[0]){var reader=new FileReader();var image=new Image();var file=input.files[0];var srcBase64=null;var _this=this;var eventFileReady=$.Event(\"dropify.fileReady\");this.clearErrors();this.showLoader();this.setFileInformations(file);this.errorsEvent.errors=[];this.checkFileSize();this.isFileExtensionAllowed();if(this.isImage()&&this.file.size<this.sizeToByte(this.settings.maxFileSizePreview)){this.input.on('dropify.fileReady',this.onFileReady);reader.readAsDataURL(file);reader.onload=function(_file){srcBase64=_file.target.result;image.src=_file.target.result;image.onload=function(){_this.setFileDimensions(this.width,this.height);_this.validateImage();_this.input.trigger(eventFileReady,[true,srcBase64]);};}.bind(this);}else{this.onFileReady(false);}}};Dropify.prototype.onFileReady=function(event,previewable,src){this.input.off('dropify.fileReady',this.onFileReady);if(this.errorsEvent.errors.length===0){this.setPreview(previewable,src);}else{this.input.trigger(this.errorsEvent,[this]);for(var i=this.errorsEvent.errors.length-1;i>=0;i--){var errorNamespace=this.errorsEvent.errors[i].namespace;var errorKey=errorNamespace.split('.').pop();this.showError(errorKey);}if(typeof this.errorsContainer!==\"undefined\"){this.errorsContainer.addClass('visible');var errorsContainer=this.errorsContainer;setTimeout(function(){errorsContainer.removeClass('visible');},this.settings.errorTimeout);}this.wrapper.addClass('has-error');this.resetPreview();this.clearElement();}};Dropify.prototype.setFileInformations=function(file){this.file.object=file;this.file.name=file.name;this.file.size=file.size;this.file.type=file.type;this.file.width=null;this.file.height=null;};Dropify.prototype.setFileDimensions=function(width,height){this.file.width=width;this.file.height=height;};Dropify.prototype.setPreview=function(previewable,src){this.wrapper.removeClass('has-error').addClass('has-preview');this.filenameWrapper.children('.dropify-filename-inner').html(this.file.name);var render=this.preview.children('.dropify-render');this.hideLoader();if(previewable===true){var imgTag=$('<img />').attr('src',src);if(this.settings.height){imgTag.css(\"max-height\",this.settings.height);}imgTag.appendTo(render);}else{$('<i />').attr('class','dropify-font-file').appendTo(render);$('<span class=\"dropify-extension\" />').html(this.getFileType()).appendTo(render);}this.preview.fadeIn();};Dropify.prototype.resetPreview=function(){this.wrapper.removeClass('has-preview');var render=this.preview.children('.dropify-render');render.find('.dropify-extension').remove();render.find('i').remove();render.find('img').remove();this.preview.hide();this.hideLoader();};Dropify.prototype.cleanFilename=function(src){var filename=src.split('\\\\').pop();if(filename==src){filename=src.split('/').pop();}return src!==\"\"?filename:'';};Dropify.prototype.clearElement=function(){if(this.errorsEvent.errors.length===0){var eventBefore=$.Event(\"dropify.beforeClear\");this.input.trigger(eventBefore,[this]);if(eventBefore.result!==false){this.resetFile();this.input.val('');this.resetPreview();this.input.trigger($.Event(\"dropify.afterClear\"),[this]);}}else{this.resetFile();this.input.val('');this.resetPreview();}};Dropify.prototype.resetFile=function(){this.file.object=null;this.file.name=null;this.file.size=null;this.file.type=null;this.file.width=null;this.file.height=null;};Dropify.prototype.setContainerSize=function(){if(this.settings.height){this.wrapper.height(this.settings.height);}};Dropify.prototype.isTouchDevice=function(){return(('ontouchstart'in window)||(navigator.MaxTouchPoints>0)||(navigator.msMaxTouchPoints>0));};Dropify.prototype.getFileType=function(){return this.file.name.split('.').pop().toLowerCase();};Dropify.prototype.isImage=function(){if(this.settings.imgFileExtensions.indexOf(this.getFileType())!=\"-1\"){return true;}return false;};Dropify.prototype.isFileExtensionAllowed=function(){if(this.settings.allowedFileExtensions.indexOf('*')!=\"-1\"||this.settings.allowedFileExtensions.indexOf(this.getFileType())!=\"-1\"){return true;}this.pushError(\"fileExtension\");return false;};Dropify.prototype.translateMessages=function(){for(var name in this.settings.tpl){for(var key in this.settings.messages){this.settings.tpl[name]=this.settings.tpl[name].replace('{{ '+key+' }}',this.settings.messages[key]);}}};Dropify.prototype.checkFileSize=function(){if(this.sizeToByte(this.settings.maxFileSize)!==0&&this.file.size>this.sizeToByte(this.settings.maxFileSize)){this.pushError(\"fileSize\");}};Dropify.prototype.sizeToByte=function(size){var value=0;if(size!==0){var unit=size.slice(-1).toUpperCase(),kb=1024,mb=kb*1024,gb=mb*1024;if(unit==='K'){value=parseFloat(size)*kb;}else if(unit==='M'){value=parseFloat(size)*mb;}else if(unit==='G'){value=parseFloat(size)*gb;}}return value;};Dropify.prototype.validateImage=function(){if(this.settings.minWidth!==0&&this.settings.minWidth>=this.file.width){this.pushError(\"minWidth\");}if(this.settings.maxWidth!==0&&this.settings.maxWidth<=this.file.width){this.pushError(\"maxWidth\");}if(this.settings.minHeight!==0&&this.settings.minHeight>=this.file.height){this.pushError(\"minHeight\");}if(this.settings.maxHeight!==0&&this.settings.maxHeight<=this.file.height){this.pushError(\"maxHeight\");}if(this.settings.allowedFormats.indexOf(this.getImageFormat())==\"-1\"){this.pushError(\"imageFormat\");}};Dropify.prototype.getImageFormat=function(){if(this.file.width==this.file.height){return\"square\";}if(this.file.width<this.file.height){return\"portrait\";}if(this.file.width>this.file.height){return\"landscape\";}};Dropify.prototype.pushError=function(errorKey){var e=$.Event(\"dropify.error.\"+errorKey);this.errorsEvent.errors.push(e);this.input.trigger(e,[this]);};Dropify.prototype.clearErrors=function(){if(typeof this.errorsContainer!==\"undefined\"){this.errorsContainer.children('ul').html('');}};Dropify.prototype.showError=function(errorKey){if(typeof this.errorsContainer!==\"undefined\"){this.errorsContainer.children('ul').append('<li>'+this.getError(errorKey)+'</li>');}};Dropify.prototype.getError=function(errorKey){var error=this.settings.error[errorKey],value='';if(errorKey==='fileSize'){value=this.settings.maxFileSize;}else if(errorKey==='minWidth'){value=this.settings.minWidth;}else if(errorKey==='maxWidth'){value=this.settings.maxWidth;}else if(errorKey==='minHeight'){value=this.settings.minHeight;}else if(errorKey==='maxHeight'){value=this.settings.maxHeight;}else if(errorKey==='imageFormat'){value=this.settings.allowedFormats.join(', ');}else if(errorKey==='fileExtension'){value=this.settings.allowedFileExtensions.join(', ');}if(value!==''){return error.replace('{{ value }}',value);}return error;};Dropify.prototype.showLoader=function(){if(typeof this.loader!==\"undefined\"){this.loader.show();}};Dropify.prototype.hideLoader=function(){if(typeof this.loader!==\"undefined\"){this.loader.hide();}};Dropify.prototype.destroy=function(){this.input.siblings().remove();this.input.unwrap();this.isInit=false;};Dropify.prototype.init=function(){this.createElements();};Dropify.prototype.isDropified=function(){return this.isInit;};$.fn[pluginName]=function(options){this.each(function(){if(!$.data(this,pluginName)){$.data(this,pluginName,new Dropify(this,options));}});return this;};return Dropify;}));";
